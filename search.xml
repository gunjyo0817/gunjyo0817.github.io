<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>2021 AIS3 Pre-exam write-up</title>
      <link href="/2022/04/04/2021-AIS3-Pre-exam-write-up/"/>
      <url>/2022/04/04/2021-AIS3-Pre-exam-write-up/</url>
      
        <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><strong>script</strong></p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>n <span class="token operator">=</span> <span class="token number">23662270311503602529211462628663973377651035055221337186547659666520360329842954292759496973737109678655075242892199643594552737098393308599593056828393773327639809644570618472781338585802514939812387999523164606025662379300143159103239039862833152034195535186138249963826772564309026532268561022599227047</span>e <span class="token operator">=</span> <span class="token number">65537</span>c <span class="token operator">=</span> <span class="token number">11458615427536252698065643586706850515055080432343893818398610010478579108516179388166781637371605857508073447120074461777733767824330662610330121174203247272860627922171793234818603728793293847713278049996058754527159158251083995933600335482394024095666411743953262490304176144151437205651312338816540536</span>count<span class="token operator">=</span><span class="token number">314159265358979323846264338327950288419716939937510582097494459230781640628620899862803482534211706798214808651328230664709384460955058223172535940812848</span>phi <span class="token operator">=</span> n<span class="token operator">-</span>count<span class="token operator">+</span><span class="token number">1</span>d <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi<span class="token punctuation">)</span>m <span class="token operator">=</span> pow<span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2021 MyFirstCTF write-up</title>
      <link href="/2022/04/04/2021-MyFirstCTF-write-up/"/>
      <url>/2022/04/04/2021-MyFirstCTF-write-up/</url>
      
        <content type="html"><![CDATA[<h2 id="Information"><a href="#Information" class="headerlink" title="Information"></a>Information</h2><table><thead><tr><th>ID</th><th>gunjyo</th></tr></thead><tbody><tr><td>Date</td><td>2021.5.22 09:30 - 17:30</td></tr><tr><td>Rank</td><td>11/282</td></tr><tr><td>Score</td><td>1362</td></tr></tbody></table><p>é€™æ˜¯æˆ‘åˆæ¬¡åƒåŠ (å¥½åƒä¹Ÿåªèƒ½åƒåŠ ä¸€æ¬¡) MyFirstCTFï¼Œç‚ºæœŸ 8 å°æ™‚ã€‚<br>é¡Œç›®æœƒèˆ‡æ¥çºŒçš„ AIS3 Pre-exam äº›å¾®é‡ç–Š(å› ç‚º AIS3 Pre-exam çš„ç¬¬ä¸€å¤©æ˜¯ MFC~)</p><p>æˆ‘çš„æ’åæ˜¯ç¬¬ 11 å ï¼Œå°ç•¶æ™‚çš„æˆ‘ä¾†èªªæ˜¯å€‹é‚„æ»¿æ»¿æ„çš„æˆç¸¾~<br>å› ç‚ºæ˜¯ PR90 ä»¥ä¸Šæ‰€ä»¥ç•¶æ™‚æœ‰é ˜åˆ°çç‹€å’Œ AIS3 çš„å¸½å­ <span class="github-emoji"><span>ğŸ˜</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f60d.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span><br><img src="https://i.imgur.com/DVqZFWL.jpg" alt="mfc rank"></p><p>äº‹ä¸é²ç–‘ï¼Œç›´æ¥é€²åˆ° write-up å§</p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Cat-Slayer-á¶ áµƒáµáµ‰-Nekogoroshi"><a href="#Cat-Slayer-á¶ áµƒáµáµ‰-Nekogoroshi" class="headerlink" title="Cat Slayer á¶ áµƒáµáµ‰ | Nekogoroshi"></a>Cat Slayer á¶ áµƒáµáµ‰ | Nekogoroshi</h3><p>Welcomeé¡Œ<br><code>TERM=xterm-256color ssh -p 5566 h173@quiz.ais3.org</code><br>é€£ç·šå¾Œæœƒè·³è½‰åˆ°è¼¸å…¥æ•¸å­—å¯†ç¢¼çš„ä»‹é¢ï¼Œåªè¦æŒ‰éŒ¯ä¸€å€‹å°±æœƒ Lock<br>æš´åŠ›å˜—è©¦å³å¯<br>å¯†ç¢¼ 2025830455298</p><blockquote><p>flag <code>AIS3{H1n4m1z4w4_Sh0k0gun}</code></p></blockquote><blockquote><p>HINT é™„ä¸Šäº†<a href="https://youtu.be/2b3Oqo13-r0?t=1296">å½±ç‰‡</a></p></blockquote><h3 id="ç¥è³€-æ–°å£çµè¡£æ–°å©šå¿«æ¨‚-ç™¼éŒ¢å›‰"><a href="#ç¥è³€-æ–°å£çµè¡£æ–°å©šå¿«æ¨‚-ç™¼éŒ¢å›‰" class="headerlink" title="[ç¥è³€] æ–°å£çµè¡£æ–°å©šå¿«æ¨‚ ç™¼éŒ¢å›‰"></a>[ç¥è³€] æ–°å£çµè¡£æ–°å©šå¿«æ¨‚ ç™¼éŒ¢å›‰</h3><p><a href="https://i.imgur.com/6olvo2O.png">é¡Œç›®æª”æ¡ˆ</a><br>ä¸‹è¼‰å¾Œè§€å¯Ÿåˆ°æ˜¯ png ï¼Œ <code>foremost</code> å¯ä»¥çœ‹åˆ°è£¡é¢æœ‰ zipæª”æ¡ˆ<br>éœ€è¦å¯†ç¢¼ ä½† zip cracker æ²’è¾¦æ³•æ‰¾åˆ°<br>çŒœæ¸¬æ˜¯ zip å½åŠ å¯†ï¼Œä¸‹è¼‰ editor æ›´æ”¹å¾Œå°±å¯ä»¥å¾—åˆ° flag çš„åœ–ç‰‡<br><a href="https://i.imgur.com/m0YfPAl.png">åŸæª”</a><br><a href="https://i.imgur.com/weIOjeu.png">æ›´æ”¹å¾Œ</a><br><a href="https://i.imgur.com/6RiHOwZ.jpg">flag</a></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Microchip"><a href="#Microchip" class="headerlink" title="Microchip"></a>Microchip</h3><div class="spoiler collapsed">    <div class="spoiler-title">        é¡Œç›®å¦‚ä¸‹    </div>    <div class="spoiler-content">        <pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"python.h"</span></span>def <span class="token function">track</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token operator">:</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">:</span>        padded <span class="token operator">=</span> name <span class="token operator">+</span> <span class="token string">"4444"</span>                                                      <span class="token function">elif</span> <span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">:</span>        padded <span class="token operator">=</span> name <span class="token operator">+</span> <span class="token string">"333"</span>                                                       <span class="token function">elif</span> <span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">:</span>        padded <span class="token operator">=</span> name <span class="token operator">+</span> <span class="token string">"22"</span>                                                        <span class="token function">elif</span> <span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">:</span>        padded <span class="token operator">=</span> name <span class="token operator">+</span> <span class="token string">"1"</span>    keys <span class="token operator">=</span> <span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    temp <span class="token operator">=</span> id    <span class="token keyword">for</span> i in <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">:</span>        keys<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>temp <span class="token operator">%</span> <span class="token number">96</span><span class="token punctuation">)</span>        temp <span class="token operator">=</span> <span class="token keyword">int</span><span class="token punctuation">(</span>temp <span class="token operator">/</span> <span class="token number">96</span><span class="token punctuation">)</span>    result <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i in <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>padded<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">:</span>   #<span class="token number">10</span> round        nums <span class="token operator">=</span> <span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> j in <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">:</span>            num <span class="token operator">=</span> <span class="token function">ord</span><span class="token punctuation">(</span>padded<span class="token punctuation">[</span>i <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">32</span>            num <span class="token operator">=</span> <span class="token punctuation">(</span>num <span class="token operator">+</span> keys<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">96</span>            nums<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>num <span class="token operator">+</span> <span class="token number">32</span><span class="token punctuation">)</span>        result <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">chr</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        result <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">chr</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        result <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">chr</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        result <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">chr</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> result  #len <span class="token operator">-</span><span class="token operator">></span> <span class="token number">40</span>name <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"flag.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">strip</span><span class="token punctuation">(</span><span class="token punctuation">)</span>id <span class="token operator">=</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token string">"key = "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"result is:"</span><span class="token punctuation">,</span> <span class="token function">track</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">)</span> </code></pre>    </div></div><p>outputï¼š <code>=Js&amp;;*A``odZHi\'&gt;D=Js&amp;#i-DYf&gt;Uy\'yuyfyu&lt;)Gu</code></p><p>å¾é¡Œç›®å¯ä»¥çœ‹åˆ°åªè¦æœ‰ key å°±å¯ä»¥ç”¨ result é€†æ¨å› flag<br>ç”± flag çš„ format <code>AIS3{}</code> å¯ä»¥æ¨ key<br>4å€‹è€Œå·²æ…¢æ…¢ç”¨æ‰‹æ¨å³å¯</p><div class="spoiler collapsed">    <div class="spoiler-title">        æ¨ key    </div>    <div class="spoiler-content">        <p>æŠŠ <code>result</code> æ¨å›é™£åˆ—(å¦‚ä¸‹script)ï¼Œå–å‰å››å€‹æ•¸å­—(6,83,42,29)</p><pre class=" language-cpp"><code class="language-cpp"><span class="token function">ord</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">32</span> <span class="token operator">=</span> <span class="token function">33</span><span class="token punctuation">(</span> <span class="token number">33</span> <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">96</span> <span class="token operator">=</span> <span class="token number">6</span> <span class="token operator">-</span><span class="token operator">></span> key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">69</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token string">'I'</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">32</span> <span class="token operator">=</span> <span class="token function">41</span><span class="token punctuation">(</span> <span class="token number">41</span> <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">96</span> <span class="token operator">=</span> <span class="token number">83</span> <span class="token operator">-</span><span class="token operator">></span> key<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">42</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token string">'S'</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">32</span> <span class="token operator">=</span> <span class="token function">51</span><span class="token punctuation">(</span> <span class="token number">51</span> <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">96</span> <span class="token operator">=</span> <span class="token number">42</span> <span class="token operator">-</span><span class="token operator">></span> key<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">87</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token string">'3'</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">32</span> <span class="token operator">=</span> <span class="token function">19</span><span class="token punctuation">(</span> <span class="token number">19</span> <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">96</span> <span class="token operator">=</span> <span class="token number">29</span> <span class="token operator">-</span><span class="token operator">></span> key<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">10</span>key<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">69</span><span class="token punctuation">,</span><span class="token number">42</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">}</span></code></pre>    </div></div><p><strong>script</strong></p><pre class=" language-cpp"><code class="language-cpp">result <span class="token operator">=</span> <span class="token string">'=Js&amp;;*A`odZHi\'>D=Js&amp;#i-DYf>Uy\'yuyfyu&lt;)Gu'</span>n <span class="token operator">=</span> <span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> i in <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">:</span>    <span class="token keyword">for</span> j in <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">:</span>        n<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token function">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token macro property">#n = [29, 42, 83, 6, 27, 10, 33, 64, 79, 68, 58, 40, 73, 7, 30, 36, 29, 42, 83, 6, 3, 73, 13, 36, 57, 70, 30, 53, 89, 7, 89, 85, 89, 70, 89, 85, 28, 9, 39, 85]</span><span class="token keyword">for</span> i in <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">:</span>    n<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>n<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>n<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>n<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> n<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>n<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>n<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>n<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token function">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token macro property">#n = [6, 83, 42, 29, 64, 33, 10, 27, 40, 58, 68, 79, 36, 30, 7, 73, 6, 83, 42, 29, 36, 13, 73, 3, 53, 30, 70, 57, 85, 89, 7, 89, 85, 89, 70, 89, 85, 39, 9, 28]</span>key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">69</span><span class="token punctuation">,</span><span class="token number">42</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token keyword">for</span> i in <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token operator">:</span>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>n<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">96</span> <span class="token operator">-</span> key<span class="token punctuation">[</span>i<span class="token operator">%</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">96</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span></code></pre><p>åŸ·è¡Œ script å¾Œå¾—åˆ°<code>AIS3{w31c0me_t0_AIS3_cryptoO0O0o0Ooo0}22</code> å¯ä»¥çœ‹åˆ° padding ç‚º 22</p><blockquote><p>flag <code>AIS3{w31c0me_t0_AIS3_cryptoO0O0o0Ooo0}</code></p></blockquote><h3 id="Judgement"><a href="#Judgement" class="headerlink" title="Judgement"></a>Judgement</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha256<span class="token keyword">import</span> stringflag <span class="token operator">=</span> <span class="token string">'AIS3{THIS_IS_A_FAKE_FLAG}'</span>cand <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_letters <span class="token operator">+</span> string<span class="token punctuation">.</span>digits <span class="token operator">+</span> <span class="token string">'_{}'</span>charset <span class="token operator">=</span> string<span class="token punctuation">.</span>printable<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">93</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>cand<span class="token punctuation">)</span>enc <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> c <span class="token keyword">in</span> flag<span class="token punctuation">:</span>    <span class="token keyword">assert</span><span class="token punctuation">(</span>c <span class="token keyword">in</span> cand<span class="token punctuation">)</span>    enc  <span class="token operator">+=</span> charset<span class="token punctuation">[</span>int<span class="token punctuation">(</span>sha256<span class="token punctuation">(</span>c<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">%</span> len<span class="token punctuation">(</span>charset<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>enc<span class="token punctuation">)</span></code></pre><p>outputï¼š<code>)g;Fk@&gt;2g;2V2J?d5G3_8V2&lt;dR2i5GZ@&lt;?2)g\j_2V&amp;?2;@[F@ek2_3"=k&amp;;2)\F2J9LL4g[W2"[2&lt;)RZ23@&lt;?2elFZ?2=@jZ23@=F2Yi52;lL5Vj2J?2J8\e@eW23e2lF330</code></p><p>å¾ˆç›´è¦ºçš„æƒ³æ³•æ˜¯æŠŠæ‰€æœ‰<code>cand</code>è£¡é¢çš„å­—å…ƒéƒ½è·‘ä¸€æ¬¡+æ¯”å°ï¼Œä½†å› ç‚ºæœ‰å¤šå€‹å­—å…ƒæœƒè·‘å‡ºåŒä¸€å€‹çµæœï¼Œæ‰€ä»¥æˆ‘æŠŠæ¯å€‹çµæœçš„å¯èƒ½æ€§éƒ½<code>print</code>å‡ºä¾†ç”¨äººå·¥æ¯”å°<br><strong>script</strong></p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha256<span class="token keyword">import</span> stringenc <span class="token operator">=</span> <span class="token string">')g;Fk@>2g;2V2J?d5G3_8V2&lt;dR2i5GZ@&lt;?2)g\j_2V&amp;?2;@[F@ek2_3"=k&amp;;2)\F2J9LL4g[W2"[2&lt;)RZ23@&lt;?2elFZ?2=@jZ23@=F2Yi52;lL5Vj2J?2J8\e@eW23e2lF330'</span><span class="token keyword">for</span> i <span class="token keyword">in</span> enc<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>end <span class="token operator">=</span> <span class="token string">' '</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> cand<span class="token punctuation">:</span>        c <span class="token operator">=</span> charset<span class="token punctuation">[</span>int<span class="token punctuation">(</span>sha256<span class="token punctuation">(</span>j<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">%</span> len<span class="token punctuation">(</span>charset<span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span>end <span class="token operator">=</span> <span class="token string">' '</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>ç¬¬ä¸€å€‹å­—å…ƒç‚ºé¡Œç›®çš„<code>enc</code> å¾Œé¢çš„æ˜¯å¯èƒ½çš„å­—å…ƒ</p><div class="spoiler collapsed">    <div class="spoiler-title">        output    </div>    <div class="spoiler-content">        <pre class=" language-cpp"><code class="language-cpp"><span class="token punctuation">)</span> A <span class="token number">8</span>g I<span class="token punctuation">;</span> SF v G <span class="token number">3</span>k x E <span class="token number">9</span> <span class="token punctuation">{</span>@ i<span class="token operator">></span> T X<span class="token number">2</span> _g I<span class="token punctuation">;</span> S<span class="token number">2</span> _V L M <span class="token number">4</span><span class="token number">2</span> _J B<span class="token operator">?</span> ed a<span class="token number">5</span> u ZG t <span class="token number">2</span><span class="token number">3</span> <span class="token number">1</span>_ q F H <span class="token number">5</span><span class="token number">8</span> UV L M <span class="token number">4</span><span class="token number">2</span> _<span class="token operator">&lt;</span> c d Kd aR y<span class="token number">2</span> _i <span class="token number">0</span><span class="token number">5</span> u ZG t <span class="token number">2</span>Z s@ i<span class="token operator">&lt;</span> c d K<span class="token operator">?</span> e<span class="token number">2</span> _<span class="token punctuation">)</span> A <span class="token number">8</span>g I\ rj D_ q F H <span class="token number">5</span><span class="token number">2</span> _V L M <span class="token number">4</span><span class="token operator">&amp;</span> R<span class="token operator">?</span> e<span class="token number">2</span> _<span class="token punctuation">;</span> S@ i<span class="token punctuation">[</span> NF v G <span class="token number">3</span>@ ie n <span class="token number">7</span>k x E <span class="token number">9</span> <span class="token punctuation">{</span><span class="token number">2</span> __ q F H <span class="token number">5</span><span class="token number">3</span> <span class="token number">1</span>" o<span class="token operator">=</span> k w Qk x E <span class="token number">9</span> <span class="token punctuation">{</span><span class="token operator">&amp;</span> R<span class="token punctuation">;</span> S<span class="token number">2</span> _<span class="token punctuation">)</span> A <span class="token number">8</span>\ rF v G <span class="token number">3</span><span class="token number">2</span> _J B<span class="token number">9</span> lL OL O<span class="token number">4</span> mg I<span class="token punctuation">[</span> NW <span class="token number">6</span><span class="token number">2</span> _" o<span class="token punctuation">[</span> N<span class="token number">2</span> _<span class="token operator">&lt;</span> c d K<span class="token punctuation">)</span> A <span class="token number">8</span>R yZ s<span class="token number">2</span> _<span class="token number">3</span> <span class="token number">1</span>@ i<span class="token operator">&lt;</span> c d K<span class="token operator">?</span> e<span class="token number">2</span> _e n <span class="token number">7</span>l hF v G <span class="token number">3</span>Z s<span class="token operator">?</span> e<span class="token number">2</span> _<span class="token operator">=</span> k w Q@ ij DZ s<span class="token number">2</span> _<span class="token number">3</span> <span class="token number">1</span>@ i<span class="token operator">=</span> k w QF v G <span class="token number">3</span><span class="token number">2</span> _Y Yi <span class="token number">0</span><span class="token number">5</span> u Z<span class="token number">2</span> _<span class="token punctuation">;</span> Sl hL O<span class="token number">5</span> u ZV L M <span class="token number">4</span>j D<span class="token number">2</span> _J B<span class="token operator">?</span> e<span class="token number">2</span> _J B<span class="token number">8</span> U\ re n <span class="token number">7</span>@ ie n <span class="token number">7</span>W <span class="token number">6</span><span class="token number">2</span> _<span class="token number">3</span> <span class="token number">1</span>e n <span class="token number">7</span><span class="token number">2</span> _l hF v G <span class="token number">3</span><span class="token number">3</span> <span class="token number">1</span><span class="token number">3</span> <span class="token number">1</span><span class="token number">0</span> <span class="token punctuation">}</span></code></pre>    </div></div><p>æŒ‰ç…§ä¸€èˆ¬è‹±æ–‡é‚è¼¯ + leet èªæ³•å»æ¯”å°ï¼Œä½†ç™¼ç¾æœ‰å¹¾å€‹ä¸å¤ªæ˜ç¢ºçš„ï¼Œå› æ­¤æŠŠå·²ç¶“æ¨å‡ºä¾†çš„ä¸Ÿåˆ°ç¶²è·¯ä¸Šä¾¿ç™¼ç¾ flag å…¶å¯¦æ˜¯ä¾†è‡ª<a href="https://www.youtube.com/watch?v=qu2tturKLLA/">sans undertale</a> <span class="github-emoji"><span>ğŸ˜‚</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f602.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p><div class="video-container"><iframe src="https://www.youtube.com/embed/qu2tturKLLA" frameborder="0" loading="lazy" allowfullscreen=""></iframe></div><blockquote><p>flag<br><code>AIS3{iT_IS_4_Beaut1FUL_day_0utside_8IrD5_4Re_SiNGin9_F1owERS_Ar3_BlOOmIN6_oN_dAys_1iKe_7h3se_</code><br><code>kiDs_1ik3_Y0u_ShOuLD_Be_BUrnin6_1n_h311}</code></p></blockquote><h3 id="ReSident-evil-villAge"><a href="#ReSident-evil-villAge" class="headerlink" title="ReSident evil villAge"></a>ReSident evil villAge</h3><blockquote><p>è¨»ï¼šæ­¤é¡Œç”¨äº†éæ­£è¦è§£</p></blockquote><div class="spoiler collapsed">    <div class="spoiler-title">        é¡Œç›® Source codeå¦‚ä¸‹    </div>    <div class="spoiler-content">        <pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> socketserver<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> binascii <span class="token keyword">import</span> unhexlify<span class="token keyword">class</span> <span class="token class-name">Task</span><span class="token punctuation">(</span>socketserver<span class="token punctuation">.</span>BaseRequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">recv</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">send</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>msg <span class="token operator">+</span> b<span class="token string">'\n'</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        privkey <span class="token operator">=</span> RSA<span class="token punctuation">.</span>generate<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>        n <span class="token operator">=</span> privkey<span class="token punctuation">.</span>n        e <span class="token operator">=</span> privkey<span class="token punctuation">.</span>e        self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>b<span class="token string">'Welcome to ReSident evil villAge, sign the name "Ethan Winters" to get the flag.'</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>b<span class="token string">'n = '</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>b<span class="token string">'e = '</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>b<span class="token string">'1) sign\n2) verify\n3) exit\n'</span><span class="token punctuation">)</span>            option <span class="token operator">=</span> self<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> option <span class="token operator">==</span> b<span class="token string">'1'</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>b<span class="token string">'Name (in hex): '</span><span class="token punctuation">)</span>                msg <span class="token operator">=</span> unhexlify<span class="token punctuation">(</span>self<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> msg <span class="token operator">==</span> b<span class="token string">'Ethan Winters'</span> <span class="token operator">or</span> bytes_to_long<span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token operator">>=</span> n<span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># msg+k*n not allowed</span>                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>b<span class="token string">'Nice try!'</span><span class="token punctuation">)</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    sig <span class="token operator">=</span> pow<span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">,</span> privkey<span class="token punctuation">.</span>d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>     <span class="token comment" spellcheck="true"># TODO: Apply hashing first to prevent forgery</span>                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>b<span class="token string">'Signature: '</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>sig<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">elif</span> option <span class="token operator">==</span> b<span class="token string">'2'</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>b<span class="token string">'Signature: '</span><span class="token punctuation">)</span>                sig <span class="token operator">=</span> int<span class="token punctuation">(</span>self<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                verified <span class="token operator">=</span> <span class="token punctuation">(</span>pow<span class="token punctuation">(</span>sig<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">==</span> bytes_to_long<span class="token punctuation">(</span>b<span class="token string">'Ethan Winters'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> verified<span class="token punctuation">:</span>                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>b<span class="token string">'AIS3{THIS_IS_A_FAKE_FLAG}'</span><span class="token punctuation">)</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>b<span class="token string">'Well done!'</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">break</span><span class="token keyword">class</span> <span class="token class-name">ForkingServer</span><span class="token punctuation">(</span>socketserver<span class="token punctuation">.</span>ForkingTCPServer<span class="token punctuation">,</span> socketserver<span class="token punctuation">.</span>TCPServer<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    HOST<span class="token punctuation">,</span> PORT <span class="token operator">=</span> <span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> <span class="token number">42069</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>HOST<span class="token punctuation">,</span> PORT<span class="token punctuation">)</span>    server <span class="token operator">=</span> ForkingServer<span class="token punctuation">(</span><span class="token punctuation">(</span>HOST<span class="token punctuation">,</span> PORT<span class="token punctuation">)</span><span class="token punctuation">,</span> Task<span class="token punctuation">)</span>    server<span class="token punctuation">.</span>allow_reuse_address <span class="token operator">=</span> <span class="token boolean">True</span>    server<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>    </div></div><p>é¡Œç›®æ˜¯ RSA ç°½è­‰ï¼Œç›®æ¨™æ˜¯æŠŠ signature é€é€²å»ä»¥é”åˆ° <code>pow(sig, e, n) == bytes_to_long(b'Ethan Winters')</code><br>åŸå‰‡ä¸Šåªè¦æŠŠ Ethan Winters è½‰æˆ hex ä¸Ÿé€²å»è®“å®ƒè·‘å‡º signature ä¹‹å¾Œï¼Œå†ä¸Ÿå›å»è®“ä»– verify å°±å¯ä»¥äº†ã€‚<br>ä½†æ˜¯å¾ <code>if msg == b'Ethan Winters' or bytes_to_long(msg) &gt;= n:  # msg+k*n not allowed</code> é€™è¡Œå¯ä»¥çœ‹åˆ° <code>check msg == Ethan Winters</code> æœƒè¢«æ“‹æ‰ã€‚<br>ç”±æ–¼é€é€²å»çš„æ˜¯å­—ä¸²ï¼Œæ–¼æ˜¯è¦è®“<strong>æ•¸å­—ä¸è®Šä½†æ˜¯å­—ä¸²æ”¹è®Š</strong>ï¼Œå°±å»å˜—è©¦ Bypassï¼Œç™¼ç¾å‰é¢åŠ ä¸Š <code>00</code> å¯ä»¥ç¹éï¼Œæ‰€ä»¥å‚³ <code>00</code> åŠ ä¸Š <code>Ethan Winters</code> è½‰æˆ <code>hex</code> å°±å¯ä»¥äº†<br>ç›´æ¥ä¸Šåœ–ã€‚<br><img src="https://i.imgur.com/Kwxy3WU.png"><br><img src="https://i.imgur.com/4dpX7qf.png"></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
      
      
      <categories>
          
          <category> write-up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> write-up </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2022/03/20/hello-world/"/>
      <url>/2022/03/20/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
